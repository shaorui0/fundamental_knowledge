# 阻塞非阻塞、同步异步

### TL;DR

本质上，异步是指是否『接收方』会通知你取结果，这是调用方式的不同；阻塞和非阻塞，是指，是否需要在某个地方等着，而不能去干其他的事情。比如信号，注册好之后，接收方完成，就会通知os内核，从而通知发出方来取

## 还是不同层次的问题。

> 这个过程同样适合另一个问题，**当你在浏览器打上url并回车的时候发生的什么？**

先梳理一下层次：

1. A端业务代码调用软件框架
2. 软件框架与操作系统内核交互
3. 从操作系统内核到网卡
4. 操作系统通过网卡发出数据，经过路由器和交换机等设计，层层转发，到达B端网卡
5. B端网卡到操作系统
6. 操作系统到B端软件框架
7. B端软件框架到B的业务代码

只有在单独一级的调用上，可以说同步还是异步的问题。

- 同步：是指调用协议中结果在调用完成时返回，这样调用的过程中参与双方都处于一个状态同步的过程。
- 异步：是指调用方**发出请求就立即返回**，**请求甚至可能还没到达接收方**，比如说放到了某个缓冲区中，等待对方取走或者第三方转交。

而结果，是通过轮询或者接收方主动推送来获得。

### 1/7过程

用户代码层面，一个接口是可以设计成异步接口的。比如：

- 某个beginXXX函数，调用完直接返回
- 回调函数，将回调函数作为参数传递，回调函数在完成时调用（python中`func`与`func()`的区别）
- 协程模型，调用接口后立即返回，切换到其他协程


### 2/6过程

系统调用层面。本质上，都是数据在用户空间和内核空间搬来搬去，都是同步接口。之用调用了一些特殊的API（IOCP），所以这一级是同步的。**阻塞与非阻塞的区别其实是影响调用接口的结果（在特定条件下是否提前返回结果），而不是调用方式。**
    是否提前返回结果，也是返回了结果，这是这是个什么样的结果。比如 FALSE, FALSE, FALSE ... TRUE!
TODO 陈硕图

### 3/5过程

内核一般通过缓冲区，使用`DMI`来传输数据，所以这一步又是异步的。

### 4过程

以太网是个**同步时序逻辑**，**随信号传输时钟**，必须两边设备**同时就绪了**才能开始传输数据，这又是同步的。

## 总结

由于通常**异步的框架**都需要在2中使用**非阻塞**的接口，的确会有很多人把非阻塞和异步混为一谈。

## 参考


[同步/异步，阻塞/非阻塞](https://www.zhihu.com/question/19732473/answer/117012135)
